doctype html
html
  head
    title Manage IRealBook Instance
    link(rel="stylesheet", type="text/css", href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css")
  body
    main.container 
      h1 Manage IRealBook Instance
      p
        strong= tuneCount
        span  Tunes / 
        strong= tuneVersionCount
        span  Versions 

      h3 Actions 
      div.container(style={display: "flex", gap: "10px"})
        form(method="post", action="?indexTunes")
          button Index Tunes 
        form(method="post", action="?explodePDFs")
          button Explode Tune PDFs
        form(method="post", action="?buildFTS")
          button Build FTS Index

      h3 Add Source
      form(method="post", enctype="multipart/form-data", action="?addSource")
        div.grid 
          label PDF File
            input(type="file", name="book", accept="application/pdf", required)
          label Index Table
            input(type="file" name="index", accept="text/csv", required)
        div.grid
          label Name
            input(name="name", placeholder="The Real Book - Volume 1", required)
          label Abbreviation (Short Name)
            input(name="shortName", placeholder="RB1", required)
        div.grid
          label Publisher
            input(name="publisher", placeholder="Hal Leonard", required)
          label Key
            select(name="key", required) 
              option C
              option Bb
              option Eb
              option Bass
        if error
          small(style={color: "var(--pico-del-color)"})= error
        button Upload

      if sources
        h3= "Available Sources (" + sources.length + ")"
        table 
          tbody 
            each source in sources
              tr 
                td
                  div(style={display: "flex"})
                    strong= source.name
                    if sourcesValidity[source.id]
                      div(data-tooltip="Valid", style={color: "var(--pico-ins-color)", width: "15px", "margin-left": "5px"})
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 512a256 256 0 1 1 0-512 256 256 0 1 1 0 512zM374 145.7c-10.7-7.8-25.7-5.4-33.5 5.3L221.1 315.2 169 263.1c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l72 72c5 5 11.8 7.5 18.8 7s13.4-4.1 17.5-9.8L379.3 179.2c7.8-10.7 5.4-25.7-5.3-33.5z"/></svg>
                    else
                      div(data-tooltip="Missing PDF or index file", style={color: "var(--pico-del-color)", width: "15px", "margin-left": "5px"})
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512zM167 167c9.4-9.4 24.6-9.4 33.9 0l55 55 55-55c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-55 55 55 55c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-55-55-55 55c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l55-55-55-55c-9.4-9.4-9.4-24.6 0-33.9z"/></svg>

                td= source.shortName
                td
                  strong= versionsPerSource[source.id]
                  span  Tunes
                td
                  div(style={display: "flex", gap: "10px"})
                    form(method="post", enctype="multipart/form-data" action="?indexTunes")
                      input(type="hidden", name="id", value=source.id)
                      button.contrast Index
                    form(method="post", enctype="multipart/form-data" action="?explodePDFs")
                      input(type="hidden", name="id", value=source.id)
                      button.contrast Extract
                    form(method="post", enctype="multipart/form-data" action="?deleteSource")
                      input(type="hidden", name="id", value=source.id)
                      button.secondary Delete
